# 1

–û—Ç–ª–∏—á–Ω–æ–µ –∏ –æ—á–µ–Ω—å –≥–ª—É–±–æ–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ Capital Market Line (CML)! –í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã ‚Äî —ç—Ç–æ –∫—Ä–∞–µ—É–≥–æ–ª—å–Ω—ã–π –∫–∞–º–µ–Ω—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–π —Ç–µ–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä—è–º–æ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–∞—à –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞.

CML ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞. –≠—Ç–æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º –¥–ª—è –≤–∞—à–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –î–∞–≤–∞–π—Ç–µ —Å–≤—è–∂–µ–º —Ç–µ–æ—Ä–∏—é —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –±–æ—Ç–æ–≤.

üéØ CML –∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
–í –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ "–±–µ–∑—Ä–∏—Å–∫–æ–≤—ã–π –∞–∫—Ç–∏–≤" ‚Äî —ç—Ç–æ –Ω–µ –æ–±–ª–∏–≥–∞—Ü–∏–∏, –∞:

–ö—ç—à –Ω–∞ –±—Ä–æ–∫–µ—Ä—Å–∫–æ–º —Å—á–µ—Ç–µ (–Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∞—è —á–∞—Å—Ç—å –∫–∞–ø–∏—Ç–∞–ª–∞).

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ (–∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—Ä–µ—â–∞–µ—Ç —Å–¥–µ–ª–∫–∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤).

–°—Ç–∞–±–∏–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (VPS, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥).

"–†–∏—Å–∫–æ–≤—ã–π –∞–∫—Ç–∏–≤" ‚Äî —ç—Ç–æ:

–í–∞—à–∏ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (MA Cross –¥–ª—è –∞–∫—Ü–∏–π, momentum –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤), –∫–∞–∂–¥–∞—è —Å–æ —Å–≤–æ–µ–π –æ–∂–∏–¥–∞–µ–º–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é (r1) –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é (œÉ1).

üß© –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –∫–æ–¥–µ: CML-–º–µ–Ω–µ–¥–∂–µ—Ä
–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å cml_manager.py –≤ –ø–∞–ø–∫–µ core/, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–ø–∏—Ç–∞–ª –º–µ–∂–¥—É "—Ä–∏—Å–∫–æ–º" (—Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏) –∏ "–∫—ç—à–µ–º" (–±–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ–º) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–∏—Å–∫–∞.

python
# core/cml_manager.py
import pandas as pd

class CMLCapitalManager:
    """
    –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–∞–ø–∏—Ç–∞–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ –ª–æ–≥–∏–∫–µ CML.
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é –¥–æ–ª—é –∫–∞–ø–∏—Ç–∞–ª–∞ –≤—ã–¥–µ–ª–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º.
    """
    def __init__(self, total_capital: float, target_risk: float, risk_free_rate: float = 0.05):
        """
        :param total_capital: –û–±—â–∏–π –∫–∞–ø–∏—Ç–∞–ª —Å—á–µ—Ç–∞ (—Ä—É–±)
        :param target_risk: –¶–µ–ª–µ–≤–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.15 –¥–ª—è 15%)
        :param risk_free_rate: –ë–µ–∑—Ä–∏—Å–∫–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (–º–æ–∂–Ω–æ –≤–∑—è—Ç—å —Å—Ç–∞–≤–∫—É –ø–æ –û–§–ó)
        """
        self.total_capital = total_capital
        self.target_risk = target_risk
        self.risk_free_rate = risk_free_rate
        self.allocated_to_risk = 0.0  # –î–æ–ª—è 'x' –≤ —Ñ–æ—Ä–º—É–ª–µ CML
    
    def calculate_allocation(self, risky_portfolio_return: float, risky_portfolio_risk: float):
        """
        –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ–ª—é –∫–∞–ø–∏—Ç–∞–ª–∞ –¥–ª—è —Ä–∏—Å–∫–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ CML.
        
        :param risky_portfolio_return: –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –í–°–ï–• –≤–∞—à–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.20)
        :param risky_portfolio_risk: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –í–°–ï–• —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.25)
        :return: –î–æ–ª—è –∫–∞–ø–∏—Ç–∞–ª–∞ 0..1+ (–µ—Å–ª–∏ >1, –Ω—É–∂–µ–Ω –∫—Ä–µ–¥–∏—Ç)
        """
        # –û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ CML: x = (—Ü–µ–ª–µ–≤–æ–π —Ä–∏—Å–∫) / (—Ä–∏—Å–∫ —Ä–∏—Å–∫–æ–≤–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è)
        # –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º: x = target_risk / risky_portfolio_risk
        x = self.target_risk / risky_portfolio_risk
        
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º: –Ω–µ –±–æ–ª–µ–µ 100% –±–µ–∑ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ –ø–ª–µ—á–∞
        x = max(0.0, min(1.0, x))
        
        self.allocated_to_risk = x
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–∂–∏–¥–∞–µ–º—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Ç–∞–∫–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è
        expected_return = x * risky_portfolio_return + (1 - x) * self.risk_free_rate
        
        return {
            'allocation_to_risk': x,
            'allocation_to_cash': 1 - x,
            'expected_return': expected_return,
            'risk_actual': x * risky_portfolio_risk  # –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è
        }
    
    def distribute_to_strategies(self, strategies: list, allocation: dict):
        """
        –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç '—Ä–∏—Å–∫–æ–≤—É—é' —á–∞—Å—Ç—å –∫–∞–ø–∏—Ç–∞–ª–∞ –º–µ–∂–¥—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏.
        
        :param strategies: –°–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏:
                          - expected_return (–æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å)
                          - risk (–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
                          - score (—Ä–µ–π—Ç–∏–Ω–≥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ 0..1)
        """
        risky_capital = self.total_capital * allocation['allocation_to_risk']
        
        # –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ score —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
        total_score = sum(s.score for s in strategies)
        
        for strategy in strategies:
            weight = strategy.score / total_score
            strategy.allocated_capital = risky_capital * weight
            print(f"{strategy.name}: –≤—ã–¥–µ–ª–µ–Ω–æ {strategy.allocated_capital:.0f} —Ä—É–±")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ main.py
if __name__ == "__main__":
    # 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä (—Ö–æ—á—É —Ä–∏—Å–∫ 12% –ø—Ä–∏ –∫–∞–ø–∏—Ç–∞–ª–µ 1 –º–ª–Ω)
    manager = CMLCapitalManager(total_capital=1_000_000, target_risk=0.12)
    
    # 2. –û—Ü–µ–Ω–∏–≤–∞–µ–º –Ω–∞—à '—Ä–∏—Å–∫–æ–≤—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å' (–Ω–∞ –æ—Å–Ω–æ–≤–µ –±—ç–∫—Ç–µ—Å—Ç–æ–≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
    # –î–æ–ø—É—Å—Ç–∏–º, –≤—Å–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–º–µ—Å—Ç–µ –¥–∞—é—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å 25% —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é 30%
    allocation = manager.calculate_allocation(
        risky_portfolio_return=0.25, 
        risky_portfolio_risk=0.30
    )
    
    print(f"–í —Ä–∏—Å–∫–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: {allocation['allocation_to_risk']*100:.1f}%")
    print(f"–í –∫—ç—à: {allocation['allocation_to_cash']*100:.1f}%")
    print(f"–û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è: {allocation['expected_return']*100:.1f}%")
üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≤–∞—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞:
text
your_algo_project/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ cml_manager.py           ‚Üê –ù–û–í–´–ô –§–ê–ô–õ (–ª–æ–≥–∏–∫–∞ CML)
‚îÇ   ‚îú‚îÄ‚îÄ portfolio.py             ‚Üê –£–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ risk_manager.py          ‚Üê –°–ª–µ–¥–∏—Ç –∑–∞ –ª–∏–º–∏—Ç–∞–º–∏, —Å—Ç–æ–ø-–ª–æ—Å—Å–∞–º–∏
‚îú‚îÄ‚îÄ strategies/
‚îÇ   ‚îú‚îÄ‚îÄ equity/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ma_cross.py
‚îÇ   ‚îî‚îÄ‚îÄ futures/
‚îÇ       ‚îî‚îÄ‚îÄ momentum.py
‚îî‚îÄ‚îÄ main.py
–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

main.py –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ —Ä–µ–∂–∏–º–µ –∞–Ω–∞–ª–∏–∑–∞ (–Ω–µ —Ç–æ—Ä–≥—É–µ—Ç).

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–≤–æ—é –æ–∂–∏–¥–∞–µ–º—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ —Ä–∏—Å–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

CML-–º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ, –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å/—Ä–∏—Å–∫ "—Ä–∏—Å–∫–æ–≤–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è" –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é –¥–æ–ª—é –∫–∞–ø–∏—Ç–∞–ª–∞ –≤—ã–¥–µ–ª–∏—Ç—å –Ω–∞ —Ç–æ—Ä–≥–æ–≤–ª—é.

–ï—Å–ª–∏ —Ä—ã–Ω–æ–∫ –≤–æ–ª–∞—Ç–∏–ª–µ–Ω (—Ä–∏—Å–∫ –≤—ã—Å–æ–∫–∏–π), CML-–º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç —Å–∫–∞–∑–∞—Ç—å: "–°–µ–≥–æ–¥–Ω—è –≤–∫–ª–∞–¥—ã–≤–∞–π —Ç–æ–ª—å–∫–æ 30% –∫–∞–ø–∏—Ç–∞–ª–∞, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –¥–µ—Ä–∂–∏ –≤ –∫—ç—à–µ".

portfolio.py —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –∏—Ö "–≤–µ—Å—É".

üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è
–°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–∞–º–æ–æ–±—É—á–∞—é—â–µ–π—Å—è, –µ—Å–ª–∏ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ:

python
# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
def update_estimates(self, actual_returns: pd.Series, actual_volatility: float):
    """
    –û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Ü–µ–Ω–∫–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏ —Ä–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –ø–µ—Ä–∏–æ–¥–æ–≤.
    """
    self.risky_portfolio_return = actual_returns.tail(20).mean()  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 –¥–Ω–µ–π
    self.risky_portfolio_risk = actual_returns.tail(20).std()
üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
–°–Ω–∞—á–∞–ª–∞ –∏–∑–º–µ—Ä—å—Ç–µ —Ä–∏—Å–∫: –ü—Ä–µ–∂–¥–µ —á–µ–º —Ç–æ—Ä–≥–æ–≤–∞—Ç—å, –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ —Ä–µ–∂–∏–º–µ –±—ç–∫—Ç–µ—Å—Ç–∞/–¥–µ–º–æ —Ö–æ—Ç—è –±—ã 2-3 –º–µ—Å—è—Ü–∞, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –∏—Ö —Ä–µ–∞–ª—å–Ω—ã–µ r1 –∏ œÉ1.

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–≤–æ–π target_risk: –ö–∞–∫—É—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ—Å–∞–¥–∫—É –≤—ã –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ—Ä–∂–∏—Ç–µ? 10%? 15%? –≠—Ç–æ –≤–∞—à œÉ –≤ —Ñ–æ—Ä–º—É–ª–µ CML.

–°–æ–∑–¥–∞–π—Ç–µ "–∫—ç—à-–±—É—Ñ–µ—Ä": –í—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∏—Ç–µ —á–∞—Å—Ç—å –∫–∞–ø–∏—Ç–∞–ª–∞ –≤ –ª–∏–∫–≤–∏–¥–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–¥–µ–Ω—å–≥–∏ –Ω–∞ —Å—á–µ—Ç–µ) ‚Äî —ç—Ç–æ –≤–∞—à (1-x).

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –ü—É—Å—Ç—å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, CML ‚Äî —ç—Ç–æ –Ω–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è, –∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤–∞—à—É –∫–æ–ª–ª–µ–∫—Ü–∏—é —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤ –≤ –µ–¥–∏–Ω—ã–π, —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å.


# 2
–û—Ç–ª–∏—á–Ω–æ, —Ç–µ–ø–µ—Ä—å –º—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –æ—Ç "—Ä–∏—Å–∫–æ–≤—ã–π –∞–∫—Ç–∏–≤ + –±–µ–∑—Ä–∏—Å–∫–æ–≤—ã–π" –∫ –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–º—É —Å–ª—É—á–∞—é ‚Äî –ø–æ—Ä—Ç—Ñ–µ–ª—å –∏–∑ –¥–≤—É—Ö —Ä–∏—Å–∫–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤. –ò–º–µ–Ω–Ω–æ —ç—Ç—É —Ñ–æ—Ä–º—É–ª—É –≤—ã –ø—Ä–∏—Å–ª–∞–ª–∏.

–≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚Äî –∫–ª—é—á–µ–≤–æ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∏–∑ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ä—ã–Ω–∫–∞.

üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —Å—Ç—Ä–æ–∏—Ç–µ –ø–æ—Ä—Ç—Ñ–µ–ª—å –∏–∑ –¥–≤—É—Ö –∞–∫—Ü–∏–π:

–†–∏—Å–∫–æ–≤—ã–π –∞–∫—Ç–∏–≤ 1 (Asset1): –∞–∫—Ü–∏–∏ –°–±–µ—Ä–±–∞–Ω–∫–∞ (SBER).

–†–∏—Å–∫–æ–≤—ã–π –∞–∫—Ç–∏–≤ 2 (Asset2): –∞–∫—Ü–∏–∏ –ù–æ—Ä–Ω–∏–∫–µ–ª—è (GMKN).

–í—ã –≤–∫–ª–∞–¥—ã–≤–∞–µ—Ç–µ:

–î–æ–ª—é x‚ÇÅ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 60% –∏–ª–∏ 0.6) –≤–∞—à–µ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞ –≤ SBER.

–û—Å—Ç–∞–≤—à—É—é—Å—è –¥–æ–ª—é (1 - x‚ÇÅ) (40% –∏–ª–∏ 0.4) ‚Äî –≤ GMKN.

–í–∞—à–∞ —Ü–µ–ª—å ‚Äî –Ω–∞–π—Ç–∏ —Ç–∞–∫–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ x‚ÇÅ, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞—Å—Ç –Ω–∞–∏–ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é –∏ —Ä–∏—Å–∫–æ–º.

üìà –§–æ—Ä–º—É–ª–∞ –æ–∂–∏–¥–∞–µ–º–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (Expected Return)
r
=
x
1
r
1
+
(
1
‚àí
x
1
)
r
2
r=x 
1
‚Äã
 r 
1
‚Äã
 +(1‚àíx 
1
‚Äã
 )r 
2
‚Äã
 
–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤.

r‚ÇÅ ‚Äî –æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å SBER –∑–∞ –ø–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, +15% –≥–æ–¥–æ–≤—ã—Ö).

r‚ÇÇ ‚Äî –æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å GMKN (–Ω–∞–ø—Ä–∏–º–µ—Ä, +12% –≥–æ–¥–æ–≤—ã—Ö).

–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ (x‚ÇÅ = 0.6, r‚ÇÅ = 0.15, r‚ÇÇ = 0.12):

–í—ã–≤–æ–¥: –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≥–¥–µ-—Ç–æ –º–µ–∂–¥—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—è–º–∏ –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –¥–∞—ë—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ.

‚ö†Ô∏è –§–æ—Ä–º—É–ª–∞ —Ä–∏—Å–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è (Portfolio Variance/Volatility) ‚Äî –ì–õ–ê–í–ù–û–ï
–ó–¥–µ—Å—å –∏ –∫—Ä–æ–µ—Ç—Å—è –≤—Å—è –º–∞–≥–∏—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –†–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è –ù–ï —è–≤–ª—è–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–∏–º –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–º —Ä–∏—Å–∫–æ–≤ –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤.

œÉ
p
2
=
x
1
2
œÉ
1
2
+
(
1
‚àí
x
1
)
2
œÉ
2
2
+
2
x
1
(
1
‚àí
x
1
)
œÅ
1
,
2
œÉ
1
œÉ
2
œÉ 
p
2
‚Äã
 =x 
1
2
‚Äã
 œÉ 
1
2
‚Äã
 +(1‚àíx 
1
‚Äã
 ) 
2
 œÉ 
2
2
‚Äã
 +2x 
1
‚Äã
 (1‚àíx 
1
‚Äã
 )œÅ 
1,2
‚Äã
 œÉ 
1
‚Äã
 œÉ 
2
‚Äã
 
–≥–¥–µ:

œÉ‚ÇÅ ‚Äî –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ) SBER (–Ω–∞–ø—Ä–∏–º–µ—Ä, 25% –∏–ª–∏ 0.25).

œÉ‚ÇÇ ‚Äî –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å GMKN (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30% –∏–ª–∏ 0.30).

œÅ‚ÇÅ‚ÇÇ (—Ä–æ) ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—è–º–∏ SBER –∏ GMKN (–æ—Ç -1 –¥–æ +1). –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä!

üß† –ü–æ—á–µ–º—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è œÅ —Ç–∞–∫ –≤–∞–∂–Ω–∞?
–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤ –¥–≤–∏–∂—É—Ç—Å—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ.

–ó–Ω–∞—á–µ–Ω–∏–µ œÅ	–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –¥–ª—è SBER –∏ GMKN?	–≠—Ñ—Ñ–µ–∫—Ç –Ω–∞ —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è
œÅ = +1 (–ü–æ–ª–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è)	–í—Å–µ–≥–¥–∞ —Ä–∞—Å—Ç—É—Ç –∏ –ø–∞–¥–∞—é—Ç –≤–º–µ—Å—Ç–µ, —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.	–ù–µ—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –†–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è ‚Äî –ø—Ä–æ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ.
œÅ = -1 (–ü–æ–ª–Ω–∞—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è)	–í—Å–µ–≥–¥–∞ –¥–≤–∏–∂—É—Ç—Å—è –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.	–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è. –ú–æ–∂–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å x‚ÇÅ, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è —Å—Ç–∞–Ω–µ—Ç –Ω—É–ª–µ–≤—ã–º!
œÅ ‚âà 0 (–ù–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)	–î–≤–∏–∂–µ–Ω–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã, —Å–ª—É—á–∞–π–Ω—ã.	–†–∏—Å–∫ –∑–∞–º–µ—Ç–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è –∑–∞ —Å—á—ë—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.
œÅ ‚âà +0.3 - +0.6 (–°–ª–∞–±–∞—è/—É–º–µ—Ä–µ–Ω–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è)	–ò–º–µ—é—Ç –æ–±—â—É—é —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é, –Ω–æ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –Ω–∞ —Ä—ã–Ω–∫–µ!	–†–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è –º–µ–Ω—å—à–µ, —á–µ–º —Å—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤.
üíª –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –≤ –∫–æ–¥–µ (Python)
–î–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å –≤ —Ä–∞–º–∫–∞—Ö —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –í–æ—Ç –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –º–æ–¥—É–ª–µ –∞–Ω–∞–ª–∏–∑–∞.

python
# portfolio_analyzer.py
import numpy as np

class TwoAssetPortfolioAnalyzer:
    """
    –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø–æ—Ä—Ç—Ñ–µ–ª—è –∏–∑ –¥–≤—É—Ö —Ä–∏—Å–∫–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤.
    """
    
    @staticmethod
    def calculate_portfolio_stats(x1: float, r1: float, r2: float, 
                                  sigma1: float, sigma2: float, rho: float):
        """
        –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è.
        
        :param x1: –î–æ–ª—è –≤ –ø–µ—Ä–≤–æ–º –∞–∫—Ç–∏–≤–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SBER)
        :param r1: –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        :param r2: –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        :param sigma1: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        :param sigma2: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        :param rho: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏
        :return: –°–ª–æ–≤–∞—Ä—å —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é, –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é –ø–æ—Ä—Ç—Ñ–µ–ª—è
        """
        # 1. –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (–≤–∞—à–∞ –ø–µ—Ä–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞)
        expected_return = x1 * r1 + (1 - x1) * r2
        
        # 2. –î–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è (–≤–∞—à–∞ –≤—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º—É–ª–∞)
        variance = (x1**2 * sigma1**2 + 
                   (1 - x1)**2 * sigma2**2 + 
                   2 * x1 * (1 - x1) * rho * sigma1 * sigma2)
        
        # 3. –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ) - –∫–æ—Ä–µ–Ω—å –∏–∑ –¥–∏—Å–ø–µ—Ä—Å–∏–∏
        volatility = np.sqrt(variance)
        
        return {
            'expected_return': expected_return,
            'variance': variance,
            'volatility': volatility,
            'diversification_effect': (x1 * sigma1 + (1-x1) * sigma2) - volatility
        }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è SBER –∏ GMKN
if __name__ == "__main__":
    analyzer = TwoAssetPortfolioAnalyzer()
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–ª—è –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏)
    # SBER
    r_sber = 0.15    # 15% –æ–∂–∏–¥–∞–µ–º–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    sigma_sber = 0.25 # 25% –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    # GMKN
    r_gmkn = 0.12    # 12% –æ–∂–∏–¥–∞–µ–º–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    sigma_gmkn = 0.30 # 30% –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è (—Ç–∏–ø–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∞–∫—Ü–∏–π –æ–¥–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞)
    rho = 0.45
    
    print("=== –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è SBER + GMKN ===")
    
    # –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –¥–æ–ª–∏ SBER –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ
    for x_sber in [0.0, 0.3, 0.6, 1.0]:
        stats = analyzer.calculate_portfolio_stats(
            x1=x_sber, r1=r_sber, r2=r_gmkn,
            sigma1=sigma_sber, sigma2=sigma_gmkn, rho=rho
        )
        
        print(f"\n–î–æ–ª—è SBER: {x_sber:.0%}")
        print(f"  –û–∂–∏–¥. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {stats['expected_return']:.2%}")
        print(f"  –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: {stats['volatility']:.2%}")
        print(f"  –≠—Ñ—Ñ–µ–∫—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: {stats['diversification_effect']:.2%}")
–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

text
=== –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è SBER + GMKN ===

–î–æ–ª—è SBER: 0%
  –û–∂–∏–¥. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 12.00%
  –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: 30.00%
  –≠—Ñ—Ñ–µ–∫—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: 0.00%

–î–æ–ª—è SBER: 30%
  –û–∂–∏–¥. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 12.90%
  –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: 26.24%  <-- –ó–∞–º–µ—Ç—å—Ç–µ: –º–µ–Ω—å—à–µ, —á–µ–º —Å—Ä–µ–¥–Ω–µ–µ (28.5%)!
  –≠—Ñ—Ñ–µ–∫—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: 2.26%

–î–æ–ª—è SBER: 60%
  –û–∂–∏–¥. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 13.80%
  –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: 23.53%  <-- –ï—â—ë –ª—É—á—à–µ!
  –≠—Ñ—Ñ–µ–∫—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: 3.47%

–î–æ–ª—è SBER: 100%
  –û–∂–∏–¥. –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 15.00%
  –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: 25.00%
  –≠—Ñ—Ñ–µ–∫—Ç –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: 0.00%
üéØ –ö–∞–∫ —ç—Ç–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏?
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ä–Ω—ã–π —Ç—Ä–µ–π–¥–∏–Ω–≥ SBER vs GAZP), –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —ç—Ç—É —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –æ–±—â–µ–≥–æ —Ä–∏—Å–∫–∞.

–í –º–æ–¥—É–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º, –∞ —Å —É—á—ë—Ç–æ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –Ω–∏–º–∏.

–ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–∫—Ç–∏–≤–æ–≤ –¥–ª—è –ø–æ—Ä—Ç—Ñ–µ–ª—è –≤—ã –∏—â–µ—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å –Ω–∏–∑–∫–æ–π –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π (œÅ –±–ª–∏–∑–∫–æ–µ –∫ 0 –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ) ‚Äî —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–Ω–∏–∑–∏—Ç –æ–±—â–∏–π —Ä–∏—Å–∫.

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è "Efficient Frontier" ‚Äî —ç—Ç–æ —Ä–∞–∑–≤–∏—Ç–∏–µ –¥–∞–Ω–Ω–æ–π –∏–¥–µ–∏: –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–æ–≤ –∏—â–µ—Ç—Å—è –Ω–∞–±–æ—Ä –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∏—Å–∫–∞ –¥–∞—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å.

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ö–æ–≥–¥–∞ –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç FINAM API, –≤—ã —Å–º–æ–∂–µ—Ç–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ œÉ‚ÇÅ, œÉ‚ÇÇ –∏ œÅ –¥–ª—è –ª—é–±—ã—Ö –ø–∞—Ä –∞–∫—Ç–∏–≤–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SBER –∏ Si-—Ñ—å—é—á–µ—Ä—Å–∞) –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ x‚ÇÅ –¥–ª—è –≤–∞—à–µ–≥–æ —É—Ä–æ–≤–Ω—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–∏—Å–∫–∞.

 # 3
 –≠—Ç–æ —Ñ–æ—Ä–º—É–ª–∞ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –ì—Ä–∞–Ω–∏—Ü—ã (Efficient Frontier) –¥–ª—è –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤ ‚Äî —Å–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–µ—Å–∫–∏–π —à–∞–≥ –ø–æ—Å–ª–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∏–∑ –¥–≤—É—Ö —Ä–∏—Å–∫–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–æ–≤. –≠—Ç–æ —è–¥—Ä–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–π —Ç–µ–æ—Ä–∏–∏ –ú–∞—Ä–∫–æ–≤–∏—Ü–∞.

–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ—ë –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ç–æ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏.

üìà –ß—Ç–æ —Ç–∞–∫–æ–µ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ì—Ä–∞–Ω–∏—Ü–∞?
–≠—Ç–æ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ "—Ä–∏—Å–∫-–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å". –ù–æ –Ω–µ –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–∏. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ ‚Äî —ç—Ç–æ –≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å –∫—Ä–∏–≤–æ–π, –≥–¥–µ –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∏—Å–∫–∞ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å.

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: –µ—Å–ª–∏ –≤–∞—à –ø–æ—Ä—Ç—Ñ–µ–ª—å –ª–µ–∂–∏—Ç –ù–ê —ç—Ç–æ–π –≥—Ä–∞–Ω–∏—Ü–µ ‚Äî –≤—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã. –ï—Å–ª–∏ –Ω–∏–∂–µ –≥—Ä–∞–Ω–∏—Ü—ã ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –±–µ–∑ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∏—Å–∫–∞.

üßÆ –†–∞–∑–±–æ—Ä —Ñ–æ—Ä–º—É–ª—ã —à–∞–≥ –∑–∞ —à–∞–≥–æ–º
1. –¶–µ–ª—å —Ñ–æ—Ä–º—É–ª—ã
–ú—ã —Ö–æ—Ç–∏–º –≤—ã—Ä–∞–∑–∏—Ç—å —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è (œÉ) –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –∂–µ–ª–∞–µ–º—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (r), –∞ –Ω–µ —á–µ—Ä–µ–∑ –¥–æ–ª—é 
x
1
x 
1
‚Äã
 .

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ: "–Ø —Ö–æ—á—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å 14% –æ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—è –∏–∑ SBER –∏ GMKN. –ö–∞–∫–æ–π –ø—Ä–∏ —ç—Ç–æ–º –±—É–¥–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑–º–æ–∂–Ω—ã–π —Ä–∏—Å–∫ –∏ –≤ –∫–∞–∫–∏—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏—è—Ö –º–Ω–µ –Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å —ç—Ç–∏ –∞–∫—Ü–∏–∏?"

2. –í—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∏ 
x
1
x 
1
‚Äã
  —á–µ—Ä–µ–∑ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
–ò–∑ —Ñ–æ—Ä–º—É–ª—ã –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è:

r
=
x
1
r
1
+
(
1
‚àí
x
1
)
r
2
r=x 
1
‚Äã
 r 
1
‚Äã
 +(1‚àíx 
1
‚Äã
 )r 
2
‚Äã
 
–≤—ã—Ä–∞–∂–∞–µ–º 
x
1
x 
1
‚Äã
 :

x
1
=
r
‚àí
r
2
r
1
‚àí
r
2
x 
1
‚Äã
 = 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r‚àír 
2
‚Äã
 
‚Äã
 
–ü—Ä–∏–º–µ—Ä: –ü—É—Å—Ç—å 
r
1
=
0.15
r 
1
‚Äã
 =0.15 (SBER, 15%), 
r
2
=
0.12
r 
2
‚Äã
 =0.12 (GMKN, 12%), –∞ –º—ã —Ö–æ—Ç–∏–º 
r
=
0.14
r=0.14 (14%).

x
1
=
0.14
‚àí
0.12
0.15
‚àí
0.12
=
0.02
0.03
‚âà
0.667
x 
1
‚Äã
 = 
0.15‚àí0.12
0.14‚àí0.12
‚Äã
 = 
0.03
0.02
‚Äã
 ‚âà0.667
–¢–æ –µ—Å—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è 14% –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –≤–ª–æ–∂–∏—Ç—å 66.7% –≤ SBER –∏ 33.3% –≤ GMKN.

3. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ñ–æ—Ä–º—É–ª—É –¥–∏—Å–ø–µ—Ä—Å–∏–∏
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è:

œÉ
p
2
=
x
1
2
œÉ
1
2
+
(
1
‚àí
x
1
)
2
œÉ
2
2
+
2
x
1
(
1
‚àí
x
1
)
œÅ
œÉ
1
œÉ
2
œÉ 
p
2
‚Äã
 =x 
1
2
‚Äã
 œÉ 
1
2
‚Äã
 +(1‚àíx 
1
‚Äã
 ) 
2
 œÉ 
2
2
‚Äã
 +2x 
1
‚Äã
 (1‚àíx 
1
‚Äã
 )œÅœÉ 
1
‚Äã
 œÉ 
2
‚Äã
 
–ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º 
x
1
=
r
‚àí
r
2
r
1
‚àí
r
2
x 
1
‚Äã
 = 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r‚àír 
2
‚Äã
 
‚Äã
  –∏ 
1
‚àí
x
1
=
r
1
‚àí
r
r
1
‚àí
r
2
1‚àíx 
1
‚Äã
 = 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r 
1
‚Äã
 ‚àír
‚Äã
 :

–í –≤–∞—à–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –æ–ø–µ—á–∞—Ç–∫–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —á–ª–µ–Ω–µ. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–ª–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:

œÉ
2
(
r
)
=
(
r
‚àí
r
2
r
1
‚àí
r
2
)
2
œÉ
1
2
+
(
r
1
‚àí
r
r
1
‚àí
r
2
)
2
œÉ
2
2
+
2
(
r
‚àí
r
2
r
1
‚àí
r
2
)
(
r
1
‚àí
r
r
1
‚àí
r
2
)
œÅ
œÉ
1
œÉ
2
œÉ 
2
 (r)=( 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r‚àír 
2
‚Äã
 
‚Äã
 ) 
2
 œÉ 
1
2
‚Äã
 +( 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r 
1
‚Äã
 ‚àír
‚Äã
 ) 
2
 œÉ 
2
2
‚Äã
 +2( 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r‚àír 
2
‚Äã
 
‚Äã
 )( 
r 
1
‚Äã
 ‚àír 
2
‚Äã
 
r 
1
‚Äã
 ‚àír
‚Äã
 )œÅœÉ 
1
‚Äã
 œÉ 
2
‚Äã
 
–≥–¥–µ 
œÅ
œÉ
1
œÉ
2
=
œÉ
12
œÅœÉ 
1
‚Äã
 œÉ 
2
‚Äã
 =œÉ 
12
‚Äã
  (–∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è).

üíª –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ Python –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
–í–æ—Ç –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç—Ä–æ–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –≥—Ä–∞–Ω–∏—Ü—É –∏ –Ω–∞—Ö–æ–¥–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—Ñ–µ–ª–∏:

python
import numpy as np
import matplotlib.pyplot as plt
from typing import Tuple, Dict

class TwoAssetEfficientFrontier:
    """
    –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü—ã –ú–∞—Ä–∫–æ–≤–∏—Ü–∞ –¥–ª—è –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤.
    """
    
    def __init__(self, r1: float, r2: float, sigma1: float, sigma2: float, rho: float):
        """
        :param r1: –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, SBER)
        :param r2: –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, GMKN)
        :param sigma1: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        :param sigma2: –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∏–≤–∞
        :param rho: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–∞–º–∏
        """
        self.r1, self.r2 = r1, r2
        self.sigma1, self.sigma2 = sigma1, sigma2
        self.rho = rho
        self.cov = rho * sigma1 * sigma2  # –ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è
    
    def portfolio_stats(self, x1: float) -> Tuple[float, float]:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∏ —Ä–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–π –¥–æ–ª–∏ x1"""
        r = x1 * self.r1 + (1 - x1) * self.r2
        variance = (x1**2 * self.sigma1**2 + 
                   (1-x1)**2 * self.sigma2**2 + 
                   2*x1*(1-x1)*self.cov)
        sigma = np.sqrt(variance)
        return r, sigma
    
    def efficient_frontier(self, num_points: int = 100) -> Dict:
        """–°—Ç—Ä–æ–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –≥—Ä–∞–Ω–∏—Ü—É"""
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ–ª–∏ x1 –æ—Ç -0.5 –¥–æ 1.5 (—Å –∫—Ä–µ–¥–∏—Ç–Ω—ã–º –ø–ª–µ—á–æ–º)
        x1_values = np.linspace(-0.5, 1.5, num_points)
        
        returns = []
        risks = []
        x1_list = []
        
        for x1 in x1_values:
            r, sigma = self.portfolio_stats(x1)
            returns.append(r)
            risks.append(sigma)
            x1_list.append(x1)
        
        # –ù–∞—Ö–æ–¥–∏–º –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∏—Å–∫–æ–º (–≤–µ—Ä—à–∏–Ω—É –≥—Ä–∞–Ω–∏—Ü—ã)
        min_risk_idx = np.argmin(risks)
        
        return {
            'returns': np.array(returns),
            'risks': np.array(risks),
            'x1_values': np.array(x1_list),
            'min_risk_portfolio': {
                'x1': x1_list[min_risk_idx],
                'return': returns[min_risk_idx],
                'risk': risks[min_risk_idx]
            }
        }
    
    def find_portfolio_for_target_return(self, target_return: float) -> Dict:
        """–ù–∞—Ö–æ–¥–∏—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –∑–∞–¥–∞–Ω–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é –∏ –µ–≥–æ —Ä–∏—Å–∫"""
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ü–µ–ª–µ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–∏–º–∞
        min_return, max_return = min(self.r1, self.r2), max(self.r1, self.r2)
        if not (min_return <= target_return <= max_return):
            return None
        
        # –í—ã—á–∏—Å–ª—è–µ–º –¥–æ–ª—é –ø–æ —Ñ–æ—Ä–º—É–ª–µ
        x1 = (target_return - self.r2) / (self.r1 - self.r2)
        r, sigma = self.portfolio_stats(x1)
        
        # –í—ã—á–∏—Å–ª—è–µ–º —Ä–∏—Å–∫ –ø–æ —Ñ–æ—Ä–º—É–ª–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)
        term1 = ((target_return - self.r2)/(self.r1 - self.r2))**2 * self.sigma1**2
        term2 = ((self.r1 - target_return)/(self.r1 - self.r2))**2 * self.sigma2**2
        term3 = 2 * ((target_return - self.r2)*(self.r1 - target_return)/((self.r1 - self.r2)**2)) * self.cov
        sigma_from_formula = np.sqrt(term1 + term2 + term3)
        
        return {
            'target_return': target_return,
            'x1': x1,
            'x2': 1 - x1,
            'calculated_return': r,
            'risk': sigma,
            'risk_from_formula': sigma_from_formula,
            'assets': ['SBER', 'GMKN']  # –ü—Ä–∏–º–µ—Ä
        }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
if __name__ == "__main__":
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ, –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Å FINAM)
    # SBER
    r_sber = 0.18      # 18% –æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    sigma_sber = 0.32  # 32% –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    
    # GMKN
    r_gmkn = 0.12      # 12% –æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    sigma_gmkn = 0.28  # 28% –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    
    # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è (–º–æ–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö)
    rho = 0.35
    
    # –°–æ–∑–¥–∞–µ–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
    frontier = TwoAssetEfficientFrontier(r_sber, r_gmkn, sigma_sber, sigma_gmkn, rho)
    
    # –°—Ç—Ä–æ–∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –≥—Ä–∞–Ω–∏—Ü—É
    result = frontier.efficient_frontier()
    
    print("=== –ê–ù–ê–õ–ò–ó –≠–§–§–ï–ö–¢–ò–í–ù–û–ô –ì–†–ê–ù–ò–¶–´ SBER + GMKN ===")
    print(f"–ü–æ—Ä—Ç—Ñ–µ–ª—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∏—Å–∫–æ–º:")
    print(f"  –î–æ–ª—è SBER: {result['min_risk_portfolio']['x1']:.1%}")
    print(f"  –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: {result['min_risk_portfolio']['return']:.2%}")
    print(f"  –†–∏—Å–∫: {result['min_risk_portfolio']['risk']:.2%}")
    print()
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–æ—Ä—Ç—Ñ–µ–ª—å –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    target = 0.15  # –•–æ—á—É 15% –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    portfolio = frontier.find_portfolio_for_target_return(target)
    
    if portfolio:
        print(f"–î–ª—è —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ {target:.1%}:")
        print(f"  SBER: {portfolio['x1']:.1%}, GMKN: {portfolio['x2']:.1%}")
        print(f"  –û–∂–∏–¥–∞–µ–º—ã–π —Ä–∏—Å–∫: {portfolio['risk']:.2%}")
        print(f"  Sharpe Ratio (–ø—Ä–∏ –±–µ–∑—Ä–∏—Å–∫–æ–≤–æ–π —Å—Ç–∞–≤–∫–µ 8%): {(target-0.08)/portfolio['risk']:.3f}")
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    plt.figure(figsize=(10, 6))
    plt.plot(result['risks']*100, result['returns']*100, 'b-', linewidth=2, label='–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞')
    
    # –û—Ç–º–µ—á–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤—ã
    plt.scatter([sigma_sber*100], [r_sber*100], color='red', s=100, label='SBER')
    plt.scatter([sigma_gmkn*100], [r_gmkn*100], color='green', s=100, label='GMKN')
    
    # –û—Ç–º–µ—á–∞–µ–º –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ä–∏—Å–∫–æ–º
    plt.scatter([result['min_risk_portfolio']['risk']*100], 
                [result['min_risk_portfolio']['return']*100], 
                color='orange', s=150, marker='*', label='–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫')
    
    if portfolio:
        # –û—Ç–º–µ—á–∞–µ–º —Ü–µ–ª–µ–≤–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å
        plt.scatter([portfolio['risk']*100], [portfolio['target_return']*100], 
                   color='purple', s=150, marker='s', label=f'–¶–µ–ª—å: {target:.0%}')
    
    plt.xlabel('–†–∏—Å–∫ (–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, %)')
    plt.ylabel('–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (%)')
    plt.title('–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞: SBER vs GMKN')
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.savefig('efficient_frontier.png', dpi=150)
    plt.show()
üéØ –ö–∞–∫ —ç—Ç–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤ –≤–∞—à–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–º –ø—Ä–æ–µ–∫—Ç–µ?
1. –í –º–æ–¥—É–ª–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–∞ –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
–ö–∞–∂–¥—É—é —Ç–æ—Ä–≥–æ–≤—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ "–∞–∫—Ç–∏–≤" —Å –µ—ë:

r·µ¢ ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è/–æ–∂–∏–¥–∞–µ–º–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å

œÉ·µ¢ ‚Äî –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏

œÅ·µ¢‚±º ‚Äî –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏

–ü—Ä–∏–º–µ—Ä: –£ –≤–∞—Å 2 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: –¢–æ—Ä–≥–æ–≤–ª—è SBER –ø–æ —Å–∫–æ–ª—å–∑—è—â–∏–º —Å—Ä–µ–¥–Ω–∏–º (r‚ÇÅ=15%, œÉ‚ÇÅ=20%)

–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: –¢–æ—Ä–≥–æ–≤–ª—è Si-—Ñ—å—é—á–µ—Ä—Å–∞–º–∏ (r‚ÇÇ=25%, œÉ‚ÇÇ=35%, œÅ=0.1)

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü—ã, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–∞ –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ –¥–ª—è –≤–∞—à–µ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞.

2. –í –º—É–ª—å—Ç–∏—Å–∏—Å—Ç–µ–º–Ω–æ–º –±–æ—Ç–µ
–ï—Å–ª–∏ –≤–∞—à –±–æ—Ç —Ç–æ—Ä–≥—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ –ø–æ–º–æ–∂–µ—Ç:

–û–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

3. –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
python
# –í –≤–∞—à–µ–º –æ—Å–Ω–æ–≤–Ω–æ–º —Ü–∏–∫–ª–µ trading_engine.py
def rebalance_portfolio(self):
    """–ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –¥–æ–ª–∏ –∞–∫—Ç–∏–≤–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö"""
    
    # 1. –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π
    stats = self.calculate_asset_statistics(window=30)  # 30 –¥–Ω–µ–π
    
    # 2. –°—Ç—Ä–æ–∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –≥—Ä–∞–Ω–∏—Ü—É
    frontier = TwoAssetEfficientFrontier(
        r1=stats['sber']['return'],
        r2=stats['gmkn']['return'],
        sigma1=stats['sber']['volatility'],
        sigma2=stats['gmkn']['volatility'],
        rho=stats['correlation']
    )
    
    # 3. –ù–∞—Ö–æ–¥–∏–º –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º Sharpe Ratio
    optimal_portfolio = frontier.find_max_sharpe_ratio(risk_free_rate=0.08)
    
    # 4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–∏
    self.adjust_positions(
        sber_target=optimal_portfolio['x1'],
        gmkn_target=optimal_portfolio['x2']
    )
üìä –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
–§–æ—Ä–º—É–ª–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–≤—É—Ö –∞–∫—Ç–∏–≤–æ–≤ –¥–ª—è –ª—é–±–æ–π —Ü–µ–ª–µ–≤–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏.

–ö—Ä–∏–≤–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ ‚Äî –≤–∞–º –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ—á–∫—É –Ω–∞ —ç—Ç–æ–π –∫—Ä–∏–≤–æ–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–µ–π —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å—é –∫ —Ä–∏—Å–∫—É.

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–¥–µ –¥–∞—ë—Ç –≤–∞–º –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º.

–≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–∞ N –∞–∫—Ç–∏–≤–æ–≤ (—Ö–æ—Ç—è —Ç–∞–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–∂–µ –Ω–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞, –∞ —á–∏—Å–ª–µ–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è).

–°–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–µ—Å–∫–∏–π —à–∞–≥ ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º –®–∞—Ä–ø–∞ (Sharpe Ratio) ‚Äî —Ç–æ—á–∫–∏, –≥–¥–µ –ª–∏–Ω–∏—è CML (–æ –∫–æ—Ç–æ—Ä–æ–π –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω–µ–µ) –∫–∞—Å–∞–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü—ã.

